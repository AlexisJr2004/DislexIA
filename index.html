<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DislexIA - Panel Administrativo</title>
    <link rel="icon" type="image/x-icon" href="static/img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8b5cf6',
                        sidebar: '#f8f9fc'
                    }
                }
            }
        }
    </script>
</head>

<body>

    <!-- Pantalla de Carga -->
    <div id="preloader" class="preloader" aria-hidden="true">
        <img src="static/img/carga.gif" alt="Cargando..." />
    </div>

    <!-- Sidebar -->
    <div class="w-56 fixed top-0 left-0 h-screen border-r border-gray-200 bg-white">
        <div class="flex flex-col h-full">
            <!-- Logo -->
            <div class="p-6">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 rounded-full overflow-hidden">
                        <img src="static/img//favicon.ico" alt="Foto de perfil" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <h1 class="text-sm font-bold text-gray-900">DislexIA</h1>
                        <p class="text-xs text-gray-500">Tu neuropsicólogos amigo</p>
                    </div>
                </div>
            </div>
            <hr class="bg-gray-400 mx-3"><br>

            <!-- Navigation -->
            <nav class="flex-1 px-3">
                <a href="#dashboard" data-page="dashboard"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-1 text-primary bg-primary/10 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 hover:shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                    </svg>
                    Panel Admnistrativo
                </a>

                <a href="#games" data-page="games"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-1 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 hover:shadow-sm">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path
                            d="M6 12h2m-1-1v2m8-1h2m-1-1v2m-9 5a4 4 0 01-4-4V9a4 4 0 014-4h10a4 4 0 014 4v4a4 4 0 01-4 4h-3l-2 2-2-2H8z" />
                    </svg>
                    Juegos
                </a>

                <a href="#calendar" data-page="calendar"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-1 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 hover:shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Calendario
                </a>

                <a href="#documents" data-page="documents"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-1 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 hover:shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    Recursos Digitales
                </a>
            </nav>

            <!-- Bottom Section -->
            <div class="p-3">
                <a href="#settings" data-page="settings"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-1 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7z" />
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09c.7 0 1.31-.4 1.51-1a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06c.51.51 1.27.67 1.82.33.5-.29 1-.81 1-1.51V3a2 2 0 1 1 4 0v.09c0 .7.4 1.31 1 1.51.55.34 1.31.18 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06c-.51.51-.67 1.27-.33 1.82.29.5.81 1 1.51 1H21a2 2 0 1 1 0 4h-.09c-.7 0-1.31.4-1.51 1z" />
                    </svg>
                    Configuraciones
                </a>


                <a href="#support" data-page="support"
                    class="nav-link flex items-center gap-3 px-3 py-2 mb-3 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8 10h.01M12 10h.01M16 10h.01M21 12c0 4.418-4.03 8-9 8-1.09 0-2.13-.18-3.08-.5L3 20l1.5-2.5A8.962 8.962 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    Soporte
                </a>


                <!-- User Profile con borde superior -->
                <a href="#profile" data-page="profile"
                    class="nav-link flex items-center gap-2 p-2 border-t border-gray-200 hover:bg-gray-100 rounded-lg cursor-pointer transition-all duration-200 hover:scale-105">
                    <div class="w-10 h-10 rounded-full overflow-hidden">
                        <img src="static/img/profile.png" alt="Foto de perfil" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-gray-900 truncate">Dr. Alexis Durán</p>
                        <p class="text-xs text-gray-500 truncate">snietod@unemi.edu.ec</p>
                    </div>
                    <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </a>
            </div>

        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-56">
        <!-- Top Bar -->
        <div class="bg-white px-8 py-4 flex items-center justify-between sticky top-0 z-10">
            <div class="flex items-center gap-3">
                <!-- Imagen de perfil -->
                <div class="w-10 h-10 rounded-full overflow-hidden">
                    <img src="static/img/profile.png" alt="Foto de perfil" class="w-full h-full object-cover">
                </div>
                <div>
                    <p class="text-sm font-semibold text-gray-900">Alexis Durán</p>
                    <p class="text-xs text-gray-500">Bienvenido</p>
                </div>
            </div>

            <div class="flex items-center gap-2">
                
                <button type="button" data-dropdown-toggle="language-dropdown-menu"
                    class="inline-flex items-center font-medium justify-center px-4 py-2 text-sm text-gray-900 dark:text-white rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 dark:hover:text-white">
                    <svg class="w-5 h-5 rounded-full me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 3900 3900">
                        <path fill="#b22234" d="M0 0h7410v3900H0z" />
                        <path d="M0 450h7410m0 600H0m0 600h7410m0 600H0m0 600h7410m0 600H0" stroke="#fff"
                            stroke-width="300" />
                        <path fill="#3c3b6e" d="M0 0h2964v2100H0z" />
                        <g fill="#fff">
                            <g id="d">
                                <g id="c">
                                    <g id="e">
                                        <g id="b">
                                            <path id="a"
                                                d="M247 90l70.534 217.082-184.66-134.164h228.253L176.466 307.082z" />
                                            <use xlink:href="#a" y="420" />
                                            <use xlink:href="#a" y="840" />
                                            <use xlink:href="#a" y="1260" />
                                        </g>
                                        <use xlink:href="#a" y="1680" />
                                    </g>
                                    <use xlink:href="#b" x="247" y="210" />
                                </g>
                                <use xlink:href="#c" x="494" />
                            </g>
                            <use xlink:href="#d" x="988" />
                            <use xlink:href="#c" x="1976" />
                            <use xlink:href="#e" x="2470" />
                        </g>
                    </svg>
                    English (US)
                </button>
                
                <button data-collapse-toggle="navbar-language" type="button"
                    class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                    aria-controls="navbar-language" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 17 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M1 1h15M1 7h15M1 13h15" />
                    </svg>
                </button>
                <div class="relative flex-1 max-w-md">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    <input type="text" placeholder="Search..."
                        class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>

                <!-- Notification Button -->
                <button
                    class="p-2.5 hover:bg-gray-100 rounded-xl text-gray-600 relative transition-all hover:scale-105">
                    <i class="far fa-bell text-lg"></i>
                    <span
                        class="absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white animate-pulse"></span>
                </button>

                <!-- Schedule Button -->
                <button
                    class="px-5 py-2.5 border border-gray-200 hover:border-gray-300 hover:bg-gray-50 rounded-xl text-sm font-medium text-gray-700 flex items-center gap-2.5 transition-all hover:shadow-sm">
                    <i class="far fa-calendar text-base"></i>
                    Schedule
                </button>

                <!-- Create Request Button -->
                <button
                    class="px-5 py-2.5 bg-gradient-to-r from-purple-300 to-purple-500 hover:from-purple-400 hover:to-purple-600 text-white rounded-xl text-sm font-semibold flex items-center gap-2.5 transition-all shadow-md hover:shadow-lg hover:scale-105">
                    <i class="fas fa-plus text-base"></i>
                    Create request
                </button>
            </div>
        </div>
        <hr class="bg-gray-400 mx-12 mt-2">

        <!-- Dynamic Content Area -->
        <div id="content-area" class="p-8">
            <!-- El contenido se cargará aquí dinámicamente -->
        </div>

    </div>

    <script>
        // Variables para manejar los estilos y scripts cargados
        let loadedPageStyles = [];
        let loadedPageScripts = [];

        // Función para limpiar recursos de página anterior
        function cleanupPreviousPage() {
            loadedPageStyles.forEach(style => style.remove());
            loadedPageStyles = [];

            loadedPageScripts.forEach(script => {
                if (script && script.parentNode) script.parentNode.removeChild(script);
            });
            loadedPageScripts = [];
        }

        // Función para actualizar navegación activa
        function updateActiveNavigation(pageName) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('text-primary', 'bg-primary/10');
                link.classList.add('text-gray-600');
                link.classList.add('hover:bg-gray-100');
            });

            const activeLink = document.querySelector(`[data-page="${pageName}"]`);
            if (activeLink) {
                activeLink.classList.add('text-primary', 'bg-primary/10');
                activeLink.classList.remove('text-gray-600');
                activeLink.classList.remove('hover:bg-gray-100');
            }
        }

        // Función para ejecutar scripts inline
        function executeInlineScript(scriptContent) {
            try {
                const wrappedScript = `(function() { ${scriptContent} })();`;
                eval(wrappedScript);
                return true;
            } catch (error) {
                console.error('Error ejecutando script:', error);
                return false;
            }
        }

        // Función principal para cargar contenido dinámico
        async function loadPage(pageName) {
            const contentArea = document.getElementById('content-area');
            contentArea.style.opacity = '0';

            cleanupPreviousPage();

            try {
                const response = await fetch(`pages/${pageName}.html`);
                const html = await response.text();

                setTimeout(() => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');

                    // Extraer estilos del head
                    doc.querySelectorAll('style').forEach(style => {
                        const newStyle = document.createElement('style');
                        newStyle.textContent = style.textContent;
                        document.head.appendChild(newStyle);
                        loadedPageStyles.push(newStyle);
                    });

                    // Extraer scripts del body
                    const bodyContent = doc.body;
                    const scripts = Array.from(bodyContent.querySelectorAll('script'));
                    scripts.forEach(s => s.remove());

                    // Insertar contenido sin scripts
                    contentArea.innerHTML = bodyContent.innerHTML;

                    // Hacer visible el contenido
                    contentArea.style.opacity = '1';

                    // Ejecutar scripts cuando el DOM está listo
                    requestAnimationFrame(() => {
                        scripts.forEach(script => {
                            if (script.src) {
                                const newScript = document.createElement('script');
                                newScript.src = script.src;
                                newScript.async = false;
                                document.body.appendChild(newScript);
                                loadedPageScripts.push(newScript);
                            } else {
                                const scriptElement = document.createElement('script');
                                scriptElement.textContent = script.textContent;
                                document.body.appendChild(scriptElement);
                                loadedPageScripts.push(scriptElement);

                                // Opcional: remover después de ejecutar
                                setTimeout(() => {
                                    if (scriptElement.parentNode) scriptElement.parentNode.removeChild(scriptElement);
                                }, 100);
                            }
                        });
                    });
                }, 150);

                // Actualizar navegación activa
                updateActiveNavigation(pageName);
            } catch (error) {
                console.error('Error loading page:', error);
                contentArea.innerHTML = '<p>Error loading content</p>';
                contentArea.style.opacity = '1';
            }
        }

        // Manejar clicks en los enlaces del sidebar
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                const pageName = link.getAttribute('data-page');
                window.location.hash = pageName;
                loadPage(pageName);
            });
        });

        // Cargar página inicial o desde URL hash
        window.addEventListener('load', () => {
            const hash = window.location.hash.slice(1) || 'dashboard';
            loadPage(hash);
        });

        // Manejar navegación del navegador (atrás/adelante)
        window.addEventListener('hashchange', () => {
            const hash = window.location.hash.slice(1) || 'dashboard';
            loadPage(hash);
        });

        // Transición de opacidad
        document.getElementById('content-area').style.transition = 'opacity 0.15s ease-in-out';

    </script>

    <script src="static/main.js"></script>

</body>

</html>